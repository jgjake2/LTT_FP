// ==UserScript==
// @name             LTT_FP++
// @namespace        jgjake2
// @description      LinusTechTips Floatplane Club Enhancer
// @author           jgjake2
// @downloadURL      https://github.com/jgjake2/LTT_FP/raw/master/LTT_FP%2B%2B.user.js
// @updateURL        https://github.com/jgjake2/LTT_FP/raw/master/LTT_FP%2B%2B.user.js
// @homepage         https://github.com/jgjake2/LTT_FP
// @supportURL       https://github.com/jgjake2/LTT_FP/issues
// @include          https://linustechtips.com/main/topic/*
// @include          https://linustechtips.com/main/forum/91-the-floatplane-club
// @include          https://linustechtips.com/main/forum/91-the-floatplane-club/*
// @require          https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js
// @require          https://code.jmod.info/velocity.min.js
// @require          https://code.jmod.info/0.0.20/jMod.min.js
// @version          0.4.3
// @grant            unsafeWindow
// @grant            GM_info
// @grant            GM_log
// @grant            GM_addStyle
// @grant            GM_getMetadata
// @grant            GM_xmlhttpRequest
// @grant            GM_registerMenuCommand
// @grant            GM_getValue
// @grant            GM_setValue
// @grant            GM_listValues
// @grant            GM_deleteValue
// @grant            GM_getResourceText
// @grant            GM_getResourceURL
// @unwrap
// @noframes
// @run-at           document-start
// @jMod             {"debug": false, "API": {"log": {"debug": false}}, "script": {"script_name": "LTT_FP++", "username": "jgjake2"}}
// ==/UserScript==
!function(e){function t(e){return e.constructor===[].constructor}function n(e){for(var t,n=0;n<P.length;n++)if((t=P[n])[0]===e)return 1===t.length||"*"===t[1]||RegExp("(?:^|\\:\\:)"+t[1].replace(/\*/gm,".*"),"i");return!1}function i(){F||(w("addSettingsButton","Settings Button Added"),_.el.elUserNav&&_.el.elUserNav.length&&(_.el.elUserNav.prepend('<li class="cJModSettings"><a href="#" id="elFullSettings" data-ipstooltip="" data-ipsmenu="" data-ipsmenu-closeonclick="false" data-ipsmenu-activeclass="lmgNavMenu_active" _title="LTT_FP++ Settings"><i class="fa fa-cog"></i></a></li>'),_.el.elFullSettings.click(function(e){return e.preventDefault(),jMod.Settings.show(),!1}),F=!0))}function o(){V||(w("init","initialized"),f())}function a(){w("onDOMReadyCB","onDOMReady Fired"),window.document&&window.document.head&&jMod.AddCSS(),o()}function r(){w("onBodyReadyCB","onBodyReady Fired"),jMod.AddCSS(),i()}function l(){w("onFooterReadyCB","onFooterReady Fired"),i()}function s(){H||(H=!0,window.document&&window.document.head&&jMod.AddCSS(),a(),_.page.onDOMReady.fire(),window.document&&document.getElementById("ipsLayout_body")&&(d(),!I&&window.document&&document.getElementById("ipsLayout_footer")&&u()))}function d(){T||(T=!0,H||s(),r(),_.page.onBodyReady.fire(),window.document&&document.getElementById("ipsLayout_footer")&&u())}function u(){I||(I=!0,H||s(),T||d(),l(),_.page.onFooterReady.fire())}function c(){return!I&&window.document&&window.document.body&&(H||s(),!T&&document.getElementById("ipsLayout_body")&&d(),T&&!I&&document.getElementById("ipsLayout_footer"))?(u(),!0):!!(H&&T&&I)||void 0}function f(){console.log("jMod.Settings Init"),jMod.Settings(_.SettingOptions)}const g=!0;var p="undefined"!=typeof unsafeWindow?unsafeWindow:this,h=this;!function(e){function t(){}function n(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function o(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?a:r)(t.promise,e._value);var i;try{i=n(e._value)}catch(e){return void r(t.promise,e)}a(t.promise,i)}))}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof o)return void d(n(o,t),e)}e._state=1,e._value=t,l(e)}catch(t){r(e,t)}}function r(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)o(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,r(t,e))})}catch(e){if(n)return;n=!0,r(t,e)}}var u=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var i=new this.constructor(t);return o(this,new s(e,n,i)),i},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function i(a,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var l=r.then;if("function"==typeof l)return void l.call(r,function(e){i(a,e)},n)}t[a]=r,0==--o&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var o=t.length,a=0;a<t.length;a++)i(a,t[a])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var i=0,o=e.length;o>i;i++)e[i].then(t,n)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){u(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},e.Promise=i}(this),function(e,t){"use strict";function n(){return 9007199254740991===r?0:++r}var i="object"==typeof window&&window||"object"==typeof h&&h||"object"==typeof self&&self||e,o="function"==typeof setImmediate,a="object"==typeof process&&!!process&&"function"==typeof process.nextTick,r=0,l=function(){var e,t,r,l;if(i.MutationObserver)return function(t){e=document.createElement("div"),new MutationObserver(function(){t(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")};if(!o&&i.postMessage&&!i.importScripts&&i.addEventListener){var s="com.setImmediate"+Math.random();l={};var d=function(e){if(e.source===i&&0===e.data.indexOf(s)){var t=e.data.split(":")[1];l[t](),delete l[t]}};return i.addEventListener("message",d,!1),function(e){var t=n();l[t]=e,i.postMessage(s+":"+t,"*")}}return!o&&i.document&&"onreadystatechange"in document.createElement("script")?function(e){(t=document.createElement("script")).onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e()},document.body.appendChild(t)}:(r=o&&setImmediate||a&&process.nextTick||setTimeout,function(e){r(e)})}();i.setAsap=l}(this),Promise._immediateFn=setAsap,jMod.CSS=`\r\nbody:not(.ipsLayout_minimal) #lmgNav {\r\n    position: absolute !important;\r\n    top: 75px !important;\r\n}\r\n#lmgNav {z-index: 1001;}\r\n.jmod-na {z-index: 16400;}\r\n.jmod-na .modal-backdrop {z-index: 16400;}\r\n.jmod-na .modal {z-index: 16500;}\r\n.jmod-na .tooltip {z-index: 16600;}\r\n.jmod-na .form-control.pref[type="text"] {\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n\theight: 32px;\r\n\tpadding: 6px 12px;\r\n\tfont-size: 13px;\r\n\tline-height: 1.42857143;\r\n\tcolor: #555;\r\n\tbackground-color: #fff;\r\n\tbackground-image: none;\r\n\tborder: 1px solid #ccc;\r\n\ttransition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;\r\n\ttransition: all border-color ease-in-out .15s,box-shadow ease-in-out .15s ease-out;\r\n\tmax-width:unset;\r\n}\r\n`;var m=function(){function e(e,t){var a=2,r=[["LTT_FP++","string",n]];for("string"==typeof t||"number"==typeof t?r=r.concat([[e||" ","%s",i],[" \n","string"],[t||"","%s",o]]):(arguments.length>1&&a--,r=r.concat([[e||"","%s",i]])),fmtBuild=new jMod.API.logFormatBuilder(r),arguments.length>a&&fmtBuild.add(" \n","string"),a;a<arguments.length;a++)fmtBuild.add(arguments[a]);jMod.Info.apply(jMod.log,fmtBuild.build())}var t='font-family:"Sansation","Open Sans",Arial;',n="display: run-in;font-weight:900;font-size:1.45em;color:#DB4105;"+t,i="display: run-in;font-weight:200;font-size:115%;color:green;"+t,o="display: run-in;font-weight:normal;font-size:100%;color:blue;";return e}(),_={el:{},log:g?console.log:function(){}},v={},y=0,b=0,P=[["Core","*"],["VideoPlayer","*"],["VideoInfo","*"]];_.getLog=function(e){function t(){a=n(e)}function i(e){return!!a&&(!(!0!==a&&!a.test(e))||void 0)}function o(t){if(arguments[0]=e+"::"+arguments[0],g&&i(t))return m.apply(m,arguments)}var a;return o.refresh=t,o.disable=function(){a=!1},o.enable=function(){a=!0},t(),o};var w=_.getLog("Core");_.addCachedElement=function(t,n){n||(n="#"+t),Object.defineProperty(_.el,t,{get:function(){return v[t]&&v[t].length||(v[t]=e(n)),v[t]},set:function(e){v[t]=e},enumerable:!0,configurable:!1})},_.addCachedElements=function(e){if(t(e))for(var n=0;n<e.length;n++)_.addCachedElement(e[n]);else for(var i in e)e[i]&&"string"==typeof e[i]?_.addCachedElement(i,e[i]):_.addCachedElement(i)},_.addCachedElements(["elUserNav","ipsLayout_header","ipsLayout_body","ipsLayout_footer","ipsLayout_contentArea","ipsLayout_mainArea","lmgNav","elFullSettings","LFPP_StickyVideoWrapper_Outer","LFPP_StickyVideoWrapper_Inner","LFPP_StickyVideoWrapper_Headline","LFPP_StickyVideoWrapper_Headline_Content","LFPP_FixedPage_Wrapper","LFPP_FixedPage_Padding"]),_.addCachedElements({headerBlock:"#ipsLayout_header .ipsResponsive_showDesktop.ipsResponsive_block",videoContainer:".video-container:has(iframe)",videoContainerIframe:".video-container > iframe",breadcrumbs:"#ipsLayout_contentWrapper > .ipsBreadcrumb.ipsBreadcrumb_top",pageTitle:"#ipsLayout_mainArea .ipsType_pageTitle > div > span > span",floatplaneDownloadWrapper:'#ipsLayout_mainArea div[id^="floatplaneDownloadWrapper_"]',floatplanePlaybackReportError:"#ipsLayout_mainArea .floatplane-script ~ p:has(a)"}),Object.defineProperties(_,{isFPClubPage:{get:function(){if(!v._isFPClubPage){var e=_.el.breadcrumbs.find('li > a[href$="the-floatplane-club/"]');v._isFPClubPage=!(!e||!e.length)}return v._isFPClubPage},set:function(e){v._isFPClubPage=!0===e},enumerable:!0,configurable:!1},isFPClubVideoPage:{get:function(){return v._isFPClubVideoPage||(v._isFPClubVideoPage=!(!_.isFPClubPage||!_.el.videoContainerIframe.length)),v._isFPClubVideoPage},set:function(e){v._isFPClubVideoPage=!0===e},enumerable:!0,configurable:!1},contentMaxWidth:{get:function(){return parseInt(_.el.ipsLayout_body.css("max-width")||-1)},enumerable:!0,configurable:!1},contentAreaWidth:{get:function(){return parseInt(_.el.ipsLayout_mainArea.css("width"))},enumerable:!0,configurable:!1},breadcrumbWidth:{get:function(){return parseInt(_.el.breadcrumbs.width())},enumerable:!0,configurable:!1}}),_.getNavHeight=function(){return Math.max(45,_.el.lmgNav&&_.el.lmgNav.length?parseInt(_.el.lmgNav.height()):-1)},_.getNavBottom=function(){return parseInt(_.el.lmgNav.height())+parseInt(_.el.lmgNav.css("top"))},_.getHeaderBlockHeight=function(){return _.el.headerBlock&&_.el.headerBlock.length?parseInt(_.el.headerBlock.height()):-1},_.getViewportHeight=function(){return y=e(window).height()},_.getViewportWidth=function(){return b=e(window).width()},_.getPageYOffset=function(){return window.pageYOffset||unsafeWindow.pageYOffset};var F=!1;!function(){function t(e){u.events[e]||(u.events[e]={hasFired:!1,_count:0,cb:{},add:function(t){for(var n in this.cb)if(this.cb[n]===t)return console.log("Handler already added: ",e,t);return this._count++,this.cb[this._count]=t,this.count},remove:function(e){if("number"==typeof e){if("function"==typeof this.cb[e]){this.cb[e]=void 0;try{delete this.cb[e]}catch(e){}if(this.cb[e]){this.cb[e]=void 0;try{delete this.cb[e]}catch(e){}}}}else console.log("invalid callback id: ",e)},fire:function(){this.hasFired=!0;for(var e in this.cb)if("function"==typeof this.cb[e])try{!1===this.cb[e].apply(this,arguments)&&this.remove(e)}catch(e){console.log(e)}}}),u.events[e]=u.events[e]||{cb:cb}}function n(e,t){u.events[e]?u.events[e].add(t):console.log('event "'+e+'" does not exist')}function i(){r=""+window.location,l=r.split("#")[0],s="#"+(r.split("#").length>1?r.split("#")[1]:""),d=u.pageIndex}function o(){var e=""+window.location;if(e!==r){var t=e.split("#")[0],n="#"+(e.split("#").length>1?e.split("#")[1]:""),o=u.pageIndex,a=r,c=l,f=s,g=d,p=t!==l,h=n!==s;i();var m={oldURL:{location:a,url:c,hash:f},newURL:{location:e,url:t,hash:n}};p&&(u.onHistoryEdit.fire(m,p,h),o!==g&&u.onPageIndexChange.fire({oldIndex:g,newIndex:o},p,h)),h&&u.onHashChange.fire(m,p,h)}}function a(){f||(f=setInterval(o,250))}var r,l,s,d,u=_.page={events:{}},c=u._cache={};_.getLog("PageHandler"),function(e){for(var n=0;7>n;n++)t(e[n])}(["historyEdit","hashChange","pageIndexChange","headerStateChange","DOMReady","BodyReady","FooterReady"]),Object.defineProperties(_.page,{isFPClubPage:{get:function(){if(!c._isFPClubPage){var e=_.el.breadcrumbs.find('li > a[href$="the-floatplane-club/"]');c._isFPClubPage=!(!e||!e.length)}return c._isFPClubPage},set:function(e){c._isFPClubPage=!0===e},enumerable:!0,configurable:!1},isFPClubVideoPage:{get:function(){return c._isFPClubVideoPage||(c._isFPClubVideoPage=!(!_.page.isFPClubPage||!_.el.videoContainerIframe.length)),c._isFPClubVideoPage},set:function(e){c._isFPClubVideoPage=!0===e},enumerable:!0,configurable:!1},hasPagination:{get:function(){var t=e("ul.ipsPagination");return!(!t||!t.length)&&e(t[0])},set:function(){},enumerable:!0,configurable:!1},activePaginationPageNum:{get:function(){var t=u.hasPagination;if(t&&t.length){var n=e("li.ipsPagination_active > a",t);if(n&&n.length){var i;try{i=parseInt(n.attr("data-page"))}catch(e){}if("number"==typeof i)return i}}return-1},set:function(){},enumerable:!0,configurable:!1},maxPaginationPages:{get:function(){var t=u.hasPagination;if(t&&t.length){var n;try{n=parseInt($active.attr("data-pages"))}catch(e){}if("number"==typeof n)return n;var i=e("li.ipsPagination_page",t);if(i&&i.length)return i.length}return-1},set:function(){},enumerable:!0,configurable:!1},pageIndex:{get:function(){var e=void 0!==window.location.search?window.location.search:window.location.query||((""+window.location).indexOf("?")>-1?(""+window.location).split("?",1)[1]:null);if(e){var t=/\bpage=(\d+)(?:[&#\?]|$)/i.exec(e);if(t&&t.length>1&&t[1]){var n;try{n=parseInt(t[1])}catch(e){}if("number"==typeof n)return n}}return u.activePaginationPageNum},set:function(){},enumerable:!0,configurable:!1},onHistoryEdit:{get:function(){return u.events.historyEdit},set:function(e){"function"==typeof e&&n("historyEdit",e)},enumerable:!0,configurable:!1},onHashChange:{get:function(){return u.events.hashChange},set:function(e){"function"==typeof e&&n("hashChange",e)},enumerable:!0,configurable:!1},onPageIndexChange:{get:function(){return u.events.pageIndexChange},set:function(e){"function"==typeof e&&n("pageIndexChange",e)},enumerable:!0,configurable:!1},onHeaderStateChange:{get:function(){return u.events.headerStateChange},set:function(e){"function"==typeof e&&n("headerStateChange",e)},enumerable:!0,configurable:!1},onDOMReady:{get:function(){return u.events.DOMReady},set:function(e){"function"==typeof e&&n("DOMReady",e)},enumerable:!0,configurable:!1},onBodyReady:{get:function(){return u.events.BodyReady},set:function(e){"function"==typeof e&&n("BodyReady",e)},enumerable:!0,configurable:!1},onFooterReady:{get:function(){return u.events.FooterReady},set:function(e){"function"==typeof e&&n("FooterReady",e)},enumerable:!0,configurable:!1}});var f=null;_.page.onBodyReady=function(){i(),setTimeout(a,100)}}(),function(){function e(){i=t.headerWindowOffsetHeight;var e={attributes:!0,attributeOldValue:!0,childList:!1,characterData:!1,subtree:!1};new MutationObserver(function(e){for(var n=0;n<e.length;n++)if("class"===e[n].attributeName){var o={oldClass:e[n].oldValue,newClass:_.el.lmgNav[0].className,oldOffset:i};o.newOffset=i=t.headerWindowOffsetHeight,t.onHeaderStateChange.fire(o);break}}).observe(_.el.lmgNav[0],e)}var t=_.header={events:{}},n=t._cache={};Object.defineProperties(_.header,{topBannerActualHeight:{get:function(){return n.topBannerActualHeight||(n.topBannerActualHeight=_.el.headerBlock.height()||75),n.topBannerActualHeight},enumerable:!0,configurable:!1},navActualHeight:{get:function(){return n.navActualHeight||(n.navActualHeight=_.el.lmgNav.height()||45),n.navActualHeight},enumerable:!0,configurable:!1},headerTotalActualHeight:{get:function(){return n.headerTotalActualHeight&&n.topBannerActualHeight&&n.navActualHeight||(n.headerTotalActualHeight=t.topBannerActualHeight+t.navActualHeight||120),n.headerTotalActualHeight},enumerable:!0,configurable:!1},headerWindowOffsetHeight:{get:function(){return t.isNavPinned?t.isNavScrolled?t.navActualHeight:Math.max(t.headerTotalActualHeight-_.getPageYOffset(),t.navActualHeight):Math.max(t.headerTotalActualHeight-_.getPageYOffset(),0)},enumerable:!0,configurable:!1},isNavPinned:{get:function(){return _.el.lmgNav.hasClass("pinned")},enumerable:!0,configurable:!1},isNavScrolled:{get:function(){return t.isNavPinned&&_.el.lmgNav.hasClass("scrolled")},enumerable:!0,configurable:!1},isTopBannerVisible:{get:function(){return!(t.isNavScrolled||!t.isNavPinned&&_.getPageYOffset()>=t.topBannerActualHeight)},enumerable:!0,configurable:!1},onHeaderStateChange:{get:function(){return _.page.events.headerStateChange},set:function(e){_.page.onHeaderStateChange=e},enumerable:!0,configurable:!1}});var i=0;_.page.onBodyReady=function(){e()}}(),function(){var t=_.videoInfo={events:{}},n=t._cache={},i=_.getLog("VideoInfo"),o=t.cache=function(){function e(e){var t,n=GM_getValue(e,"{}");try{t=JSON.parse(n)}catch(e){t={}}return t}function t(e,t){var n=JSON.stringify(t||{});return GM_setValue(e,n),t}function n(t,n,i){return e(t)[n]||i}function i(n,i,o){var a=e(n)||{};return a[i]=o,t(n,a),o}return{getVideoInfo:function(e){if(e)return n("VideoInfo",e)},setVideoInfo:function(e,t){if(e&&t)return i("VideoInfo",e,t)},getVideoDuration:function(e){if(e)return n("VideoDuration",e)},setVideoDuration:function(e,t){if(e&&t)return i("VideoDuration",e,t)}}}(),a=0;n._getVideoDuration={},t.getVideoDuration=function(t,i){return n._getVideoDuration[t]?n._getVideoDuration[t]:(n._getVideoDuration[t]=new Promise(function(r,l){var s=function(e,i){return n._getVideoDuration[t]=null,!1===i?l(e):r(e)};setAsap(function(){function n(n){e.get({url:n,dataType:"text"}).done(function(e,n,i){if(a--,e){for(var r,l=/\#EXTINF\:(\d+\.\d+)\,/gim,d=0;(r=l.exec(e))&&r&&r.length>1;)try{d+=parseFloat(r[1])}catch(e){console.log(e)}if(d)return o.setVideoDuration(t,d),s({duration:d,minutes:parseInt(d/60),seconds:parseInt(d%60)})}return s(e,!1)}).fail(function(e,t){return a--,s(e,!1)})}function r(t){e.get({url:t,dataType:"text"}).done(function(e,i,o){if(e){var r=/(chunk\.m3u8\?nimblesessionid=\d+\&wmsAuthSign=[^\r\n\s]+)/im.exec(e);if(r&&r.length>1)return n(t.replace(/playlist.m3u8.+$/i,r[1]))}return a--,s(e,!1)}).fail(function(e,t){return a--,s(e,!1)})}function l(){var n="https://linustechtips.com/main/applications/floatplane/interface/video_url.php?video_guid="+t+"&video_quality=1080";e.get({url:n,dataType:"text"}).done(function(e,t,n){return e&&/Edge\d+\-\w+\.floatplaneclub\.com/i.test(e)?r(e):(a--,s(e,!1))}).fail(function(e,t){return a--,s(e,!1)})}var d=i?null:o.getVideoDuration(t);if(d)return s({duration:d,minutes:parseInt(d/60),seconds:parseInt(d%60)});++a>1?setTimeout(l,150*a):l()})}),n._getVideoDuration[t])},n._getVideoInfo={},t.getVideoInfo=function(t,i){return n._getVideoInfo[t]?n._getVideoInfo[t]:(n._getVideoInfo[t]=new Promise(function(r,l){var s=function(e,i){return n._getVideoInfo[t]=null,!1===i?l(e):r(e)};setAsap(function(){function n(){var n="https://cms.linustechtips.com/get/videos/by_guid/"+t;e.get({url:n,dataType:"json"}).done(function(e,i,r){return a--,console.log("_doRequest: ",n," -- textStatus: ",i," -- data: ",e),e&&e.description?(o.setVideoInfo(t,e),s(e)):s(e,!1)}).fail(function(e,t){return a--,s(e,!1)})}var r=i?null:o.getVideoInfo(t);if(r)return s(r);++a>1?setTimeout(n,150*a):n()})}),n._getVideoInfo[t])},_.page.onFooterReady=function(){if(i("VideoInfo::onFooterReady"),_.page.isFPClubVideoPage)if(_.el.videoContainerIframe&&_.el.videoContainerIframe.length){var e=_.el.videoContainerIframe.attr("src"),n=/get\/player\/(.+)$/i.exec(e||"");if(n&&n.length>1){var o=n[1];t.getVideoInfo(o).then(function(e){},function(e){console.log("getVideoInfo fail: ",e)}),t.getVideoDuration(o).then(function(e){},function(e){console.log("getVideoDuration fail: ",e)})}}else console.log("no iframe")}}(),function(){function t(e,t){var n=jMod.Settings.get(e);return void 0===n?t:n}function n(t){return d[t]?d[t]:u[t]?Promise.resolve(u[t]):(d[t]=new Promise(function(n,i){var o=function(e,o){return d[t]=null,!1===o?i(e):(u[t]=e,n(e))};setAsap(function(){function n(){console.log("Use jquery request"),e.get({url:t,dataType:"html"}).done(function(n,i,a){if(s--,n){var l=e(".video-container > iframe",n);if(l&&l.length){var d=l.attr("src");if(d)return r.cache.setPageIFrameSrc(t,d),o(d)}return o("")}return o(n,!1)}).fail(function(e,t){return s--,o(e,!1)})}function i(){console.log("Use ips request"),l.getAjax()(t+"?preview=1").done(function(n){console.log("used ips ajax",n);var i=e(".video-container > iframe",e(n));if(i&&i.length){var a=i.attr("src");if(a)return r.cache.setPageIFrameSrc(t,a),o(a)}return console.log("error getting ips iframe: ",t),o("")}).fail(function(e,t,n){return console.log("Error ips ajax",e,t,n),o(n,!1)})}var a=r.cache.getPageIFrameSrc(t);if(a)return o(a);var l="undefined"!=typeof ips?ips:window.ips||p.ips;if(console.log("_ips: ",l),l&&l.ui&&l.ui.hovercard){var d=l.ui.hovercard.getCache(t+"?preview=1");if(d){var u=e(".video-container > iframe",e(d));if(u&&u.length&&u.attr("src"))return r.cache.setPageIFrameSrc(t,u.attr("src")),console.log("Used ips cache"),o(u.attr("src"))}}++s>1?setTimeout(l&&l.getAjax?i:n,250*s):l&&l.getAjax?i():n()})}),d[t])}function i(e){return c[e]?c[e]:f[e]?Promise.resolve(f[e]):(c[e]=new Promise(function(t,i){var o=function(n,o){return c[e]=null,!1===o?i(n):(f[e]=n,t(n))};setAsap(function(){var t=r.cache.getPageVideoThumbURL(e);if(t)return o(t);n(e).then(function(t){if(t){var n=/\/([^\/\\\?#&]{5,})(?:[\?#]|\/[\?#]|\/?$)/i.exec(t);if(n&&n.length>1&&n[1]){var i=n[1];return r.cache.setPageVideoId(e,i),o("https://cms.linustechtips.com/get/thumbnails/by_guid/"+i)}}else""===t&&o("");o(t,!1)},function(e){o(e,!1)})})}),c[e])}function o(t){t.addClass("thumb_processed");var n=e(".cTopicTitle > a",t);if(n&&n.length){var o=n.attr("href")||n[0].href;o&&i(o).then(function(n){function i(e,t){var n=Math.min(parseFloat(e)/parseFloat(t||h||e)*100,100);b.css("width",n+"%")}function a(){V=null;var e=parseInt(P.dataset.frame||0)+1;e>h&&(e=0),P.dataset.frame=e,v.css("margin-left",-200*e+"px"),i(e,h),F||(V=setTimeout(a,w))}function r(){if(F=!0,V){try{clearTimeout(V)}catch(e){}V=null}_.videos.settings.keep_preview_after_hover||(v.css("display","none"),y.css("display","none"))}function l(){if(F=!0,V){try{clearTimeout(V)}catch(e){}V=null}}function s(){V=null,F&&(F=!1,p&&h||(p=parseInt(v.width()),h=Math.round(p/200)),V=p?setTimeout(a,w):setTimeout(s,w))}var d=(n=n||"").replace("/thumbnails/","/sprite/"),u=/\/by_guid\/(.+)$/i.exec(n);u=u&&u.length>1&&u[1]?u[1]:null;var c=e(".ipsDataItem_icon",t).css({width:"230px","max-width":"230px","min-width":"230px"}),f=(e(".ipsDataItem_icon > a",t).css({display:"inline-block","vertical-align":"middle"}),e("i.fa-circle",t));n&&f&&f.length&&f.removeClass("fa-circle").addClass("fa-youtube-play"),c.append('<div class="LFPP_Video_Thumb_Wrapper"><a class="" href="'+o+'"><div class="LFPP_Video_Thumb_Container"><div class="LFPP_Video_Thumb"><img style="max-width:200px;width:200px;height:auto;" src="'+n+'"></div><div class="LFPP_Video_ThumbPreview"><img src="" data-frame="0" style="display:none;"></div><div class="LFPP_Video_Time" style="display:none;"></div><div class="LFPP_Video_Timeline" style="display:none;"><div class="LFPP_Video_Timeline_Bar" style=""></div><div class="LFPP_Video_Timeline_Progress" style=""></div></div></div></a></div>');var g=e(".LFPP_Video_Time",c);if(u&&_.videoInfo.getVideoDuration(u).then(function(e){g.html(e.minutes+":"+(10>e.seconds?"0":"")+e.seconds).css("display","block")},function(e){console.log(e)}),_.videos.settings.show_preview_on_hover){var p,h,m=e(".LFPP_Video_Thumb_Wrapper",c),v=e(".LFPP_Video_ThumbPreview img",c),y=e(".LFPP_Video_Timeline",c),b=e(".LFPP_Video_Timeline_Progress",c),P=v[0],w=parseInt(_.videos.settings.thumb_animation_speed||300),F=!0,V=null,S=!1;m.hover(function(){S||(v.attr("src")?(v.css("display","block"),y.css("display","block"),s()):(P.addEventListener("load",function(e){S||(v.css("display","block"),y.css("display","block"),p=parseInt(v.width()),h=Math.round(p/200))}),P.addEventListener("error",function(e){S=!0}),P.setAttribute("src",d),V=setTimeout(s,w)))},function(){r()}),y.mousemove(function(e){l();var t=e.offsetX,n=y.width(),i=Math.max(parseInt(t/n*(h||0)),0);P.dataset.frame=i,a()}),y.hover(function(e){l();var t=e.offsetX,n=y.width(),i=Math.max(parseInt(t/n*(h||0)),0);P.dataset.frame=i,a()},function(e){"IMG"===e.relatedTarget.tagName?s():r()})}},function(e){l("processPageVideoThumb","Error: ",o,e)})}}function a(){e(".ipsBox ol.cTopicList > li.ipsDataItem:not(.thumb_processed)").each(function(){var t=e(this);setAsap(function(){o(t)})})}var r=_.videos={events:{},settings:{}},l=_.getLog("VideoList");Object.defineProperties(_.videos.settings,{add_thumbs_to_video_list:{get:function(){return t("Thumbs_General",_.getSettingDefault("Thumbs_General")).indexOf("add_thumbs_to_video_list")>-1},enumerable:!0,configurable:!1},show_preview_on_hover:{get:function(){return t("Thumbs_General",_.getSettingDefault("Thumbs_General")).indexOf("show_preview_on_hover")>-1},enumerable:!0,configurable:!1},keep_preview_after_hover:{get:function(){return t("Thumbs_General",_.getSettingDefault("Thumbs_General")).indexOf("keep_preview_after_hover")>-1},enumerable:!0,configurable:!1},thumb_animation_speed:{get:function(){var e=t("thumb_animation_speed",_.getSettingDefault("thumb_animation_speed")).trim();try{return parseInt(e)}catch(e){}return _.getSettingDefault("thumb_animation_speed")},enumerable:!0,configurable:!1}}),jMod.CSS=`\r\n/*\r\n.ipsDataItem_icon {\r\n\tpadding-top: 0;\r\n\tpadding-bottom: 0;\r\n}\r\n*/\r\n\r\n\r\n.LFPP_Video_Thumb_Wrapper {\r\n\tdisplay:inline-block;\r\n\twidth:200px;\r\n\theight:112.5px;\r\n\tvertical-align:middle;\r\n}\r\n\r\n.LFPP_Video_Thumb_Wrapper a {\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n}\r\n\r\n.LFPP_Video_Thumb_Container {\r\n\tposition: absolute;\r\n\twidth: 200px;\r\n\theight: 112.5px;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\tmargin: auto 0;\r\n}\r\n\r\n.LFPP_Video_Time {\r\n\tmin-width: 20px;\r\n\theight: 14px;\r\n\tbackground-color: black;\r\n\tborder-top-left-radius: 2px;\r\n\tborder-top-right-radius: 2px;\r\n\tborder-bottom-left-radius: 2px;\r\n\tborder-bottom-right-radius: 2px;\r\n\tposition: absolute;\r\n\tbottom: 2px;\r\n\tright: 2px;\r\n\topacity: 0.75;\r\n\tcolor: white;\r\n\tfont-family: arial,sans-serif;\r\n\tfont-size: 11px;\r\n\tpadding: 0 4px;\r\n\tline-height: 14px;\r\n}\r\n\r\n.LFPP_Video_Thumb_Wrapper:hover .LFPP_Video_Time {\r\n\topacity: 1;\r\n}\r\n\r\n.LFPP_Video_Thumb {\r\n\twidth: 200px;\r\n\theight: 112.5px;\r\n\toverflow: hidden;\r\n\tposition: absolute;\r\n}\r\n\r\n.LFPP_Video_Thumb img {\r\n\tmax-width: 200px;\r\n    height: auto;\r\n    width: 200px;\r\n    margin: auto 0;\r\n    top: 0;\r\n    position: absolute;\r\n    bottom: 0;\r\n}\r\n\r\n.LFPP_Video_ThumbPreview {\r\n\tposition:absolute;\r\n\ttop:0;\r\n\tleft:0;\r\n\twidth:200px;\r\n\theight:112.5px;\r\n\toverflow:hidden;\r\n}\r\n\r\n.LFPP_Video_ThumbPreview img {\r\n\theight:112.5px;\r\n\twidth:auto;\r\n\tmargin-left:0px;\r\n}\r\n\r\n.LFPP_Video_Timeline {\r\n\twidth:100%;\r\n\tposition:absolute;\r\n\tbottom:-10px;\r\n\theight:20px;\r\n}\r\n\r\n.LFPP_Video_Timeline_Bar {\r\n\twidth:100%;\r\n\tbackground-color:rgba(128,128,128,0.8);\r\n\theight:3px;\r\n\tposition:absolute;\r\n\tbottom:10px;\r\n}\r\n\r\n.LFPP_Video_Timeline_Progress {\r\n\twidth:0px;\r\n\theight:3px;\r\n\tbackground-color:red;\r\n\tposition:absolute;\r\n\tleft:0;\r\n\tbottom:10px;\r\n}\r\n\r\n\r\n.LFPP_Video_Timeline_Progress::after{\r\n\tcontent: " ";\r\n\theight:8px;\r\n\twidth:8px;\r\n\tbackground-color:red;\r\n\tposition:absolute;\r\n\tright:-2px;\r\n\ttop:-3px;\r\n\tborder-top-right-radius: 4px;\r\n\tborder-top-left-radius: 4px;\r\n\tborder-bottom-right-radius: 4px;\r\n\tborder-bottom-left-radius: 4px;\r\n}\r\n\r\n.LFPP_Video_Timeline:not(:hover) .LFPP_Video_Timeline_Progress::after {\r\n\tdisplay:none;\r\n}\r\n\r\n.LFPP_Video_Timeline:hover .LFPP_Video_Timeline_Progress::after {\r\n\tdisplay:block !important;\r\n}\r\n\r\n`,r.cache=function(){function e(e){var t,n=GM_getValue(e,"{}");try{t=JSON.parse(n)}catch(e){t={}}return t}function t(e,t){var n=JSON.stringify(t||{});return GM_setValue(e,n),t}function n(t,n,i){return e(t)[n]||i}function i(n,i,o){var a=e(n)||{};return a[i]=o,t(n,a),o}return{getPageVideoId:function(e){if(e)return n("PageVideoId",e)},setPageVideoId:function(e,t){if(e&&t)return i("PageVideoId",e,t)},getPageIFrameSrc:function(e){if(e)return n("PageIFrameSrc",e)},setPageIFrameSrc:function(e,t){if(e&&t)return i("PageIFrameSrc",e,t)},getPageVideoThumbURL:function(e){var t=this.getPageVideoId(e);if(t)return"https://cms.linustechtips.com/get/thumbnails/by_guid/"+t}}}(),Object.defineProperties(_.videos,{isVideoListPage:{get:function(){return/\/forum\/\d+\-the\-floatplane\-club\/?/i.test(""+window.location)},set:function(e){},enumerable:!0,configurable:!1}});var s=0,d={},u={},c={},f={};_.page.onBodyReady=function(){_.videos.settings.add_thumbs_to_video_list&&r.isVideoListPage&&(l("onBodyReady","is video list page"),setAsap(a),_.page.onHistoryEdit=function(e,t,n){l("onBodyReady","onHistoryEdit fired: ",e,t,n),t&&r.isVideoListPage&&(setTimeout(a,100),setTimeout(a,1e3))},_.page.onPageIndexChange=function(e,t,n){l("onBodyReady","onPageIndexChange fired: ",e),t&&r.isVideoListPage&&(setTimeout(a,100),setTimeout(a,1e3))})}}(),function(){function t(e,t){var n=jMod.Settings.get(e);return void 0===n?t:n}function n(){var e=function(){return parseInt(_.getViewportHeight()/4)};if(v.getMinPlayerSizeSetting)return v.getMinPlayerSizeSetting;var t=_.player.settings.Min_Video_Player_Height;if(t&&"default"!==t.toLowerCase()&&/^\s*(\d+(?:\.\d+)?px|\d+\/\d+)\s*$/i.test(t))if(/^\s*\d+(?:\.\d+)?px\s*$/i.test(t))e=function(){return parseInt(t)};else if(/^\d+\/\d+$/i.test(t)){var n=t.split("/");e=function(){return parseInt(_.getViewportHeight()*parseInt(n[0])/parseInt(n[1]))}}return e}function i(){function t(){_.el.LFPP_StickyVideoWrapper_Headline_Content.find("table > tr:nth-of-type(1), table > tbody > tr:nth-of-type(1)").append(e('<td style="text-align:right;" rowspan="2"></td>').append(_.el.floatplaneDownloadWrapper.detach())),_.el.floatplaneDownloadWrapper.prepend(_.el.floatplaneDownloadWrapper.children("ul:first").detach()),_.el.floatplaneDownloadWrapper.children("ul:first").css("vertical-align","super").after('<br style="clear:both;" />'),_.el.floatplaneDownloadWrapper.children("label").attr("title","recommended if downloads aren't working, or if on mobile").html("Use native downloader").css({"margin-right":"3px","vertical-align":"super"}),_.el.floatplaneDownloadWrapper.children("span.ipsCustomInput").css("vertical-align","super"),_.el.LFPP_StickyVideoWrapper_Headline_Content.find("table > tr:nth-of-type(2), table > tbody > tr:nth-of-type(2)").append(e("<td></td>").append(_.el.floatplanePlaybackReportError.detach()))}function n(e){if(_.el.floatplaneDownloadWrapper&&_.el.floatplaneDownloadWrapper.length||e>100)return t();setTimeout(n,50,e+1)}if(!f){l("onFooterReady","addVideoPlayerWrapper"),_.el.ipsLayout_header.after('<div id="LFPP_StickyVideoWrapper_Outer" style="height:200px;"><div id="LFPP_StickyVideoWrapper_Inner"></div><div id="LFPP_StickyVideoWrapper_Headline"><div id="LFPP_StickyVideoWrapper_Headline_Content" style="max-width:'+_.contentMaxWidth+"px;width:"+_.breadcrumbWidth+'px;"></div></div></div><div id="LFPP_FixedPage_Wrapper" style="display:block;position:fixed;width:100%;"></div><div id="LFPP_FixedPage_Padding" style="display:block;width:100%;min-height:400vh;"></div>'),_.el.LFPP_FixedPage_Wrapper[0].appendChild(document.getElementById("ipsLayout_body")),_.el.LFPP_FixedPage_Wrapper[0].appendChild(document.getElementById("ipsLayout_footer"));var i=_.el.videoContainer.detach();_.el.LFPP_StickyVideoWrapper_Inner[0].appendChild(i[0]),f=!0,o.updatePageHeight(),_.el.LFPP_StickyVideoWrapper_Headline_Content.append('<table style="width:100%;"><tr><td style="min-width:50%;"><h1 style="font-size: 26px;font-weight: 400;line-height: 1.2;margin: 0;">'+_.el.pageTitle.text()+"</h1></td></tr><tr></tr></table>"),setTimeout(n,50,0),_.header.onHeaderStateChange=function(e){l("onHeaderStateChange","onHeaderStateChange fired",e),setAsap(o.onScroll)},window.addEventListener("scroll",o.onScroll,!0),e(window).on("resize orientationChange",o.onWindowResize),setAsap(o.onScroll)}}
jMod.CSS=`\r\n\r\n\r\n#ipsLayout_body {\r\n\tmargin-top:0px;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Outer {\r\n\tposition: fixed;\r\n\tmin-height: 50px;\r\n\theight: 200px;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\ttop: 45px;\r\n\tz-index: 1000;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Inner {\r\n\tbackground-color: black;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline {\r\n\tposition: relative;\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n\ttop: 0;\r\n\theight: 0;\r\n\toverflow: visible;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content {\r\n\tmin-height: 45px;\r\n\theight: fit-content;\r\n\theight: -o-fit-content;\r\n\theight: -moz-fit-content;\r\n\theight: -webkit-fit-content;\r\n\twidth: 100%;\r\n\tbackground-color: white;\r\n\tpadding: 5px 20px;\r\n\tmargin: 0 auto;\r\n\tborder-bottom-right-radius: 6px;\r\n\tborder-bottom-left-radius: 6px;\r\n\tbox-shadow: rgba(0, 0, 0, 0.1) 0px 1px 2px 0px;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content h1 {\r\n\tfont-family: "Helvetica Neue", Helvetica, Arial, "Liberation Sans", "Roboto", sans-serif;\r\n\tcolor: rgb(49, 49, 49);\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content td > p > a[target="_blank"] {\r\n\tcolor: rgba(128,128,128,0.8);\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content td > p > a[target="_blank"]:hover {\r\n\tcolor: rgba(0,0,0,1);\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content .ipsButton_split {\r\n\tvertical-align: middle;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Outer .video-container {\r\n\tpadding: 0;\r\n\theight: 100%;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Outer .video-container > iframe {\r\n\r\n}\r\n/*\r\n#LFPP_StickyVideoWrapper_Padding {\r\n\tdisplay: block;\r\n\twidth:100%;\r\n\theight: 200px;\r\n\tposition: relative;\r\n\ttop: 0;\r\n}\r\n*/\r\n\r\n\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content, .LFPP_Player_Min #LFPP_StickyVideoWrapper_Headline_Content {\r\n    -webkit-backface-visibility: hidden;\r\n\t-moz-backface-visibility: hidden;\r\n    backface-visibility: hidden;\r\n\t\r\n\t/*\r\n\t-webkit-transition: opacity 0.25s ease-in-out, top 0.25 ease-in-out;\r\n\t-moz-transition: opacity 0.25s ease-in-out, top 0.25 ease-in-out;\r\n\ttransition: opacity 0.25s ease-in-out, top 0.25 ease-in-out;\r\n\t*/\r\n\t-webkit-transition: opacity 0.25s ease-in-out;\r\n\t-moz-transition: opacity 0.25s ease-in-out;\r\n\ttransition: opacity 0.25s ease-in-out;\r\n}\r\n\r\n#LFPP_StickyVideoWrapper_Headline_Content {\r\n    -webkit-backface-visibility: hidden;\r\n\t-moz-backface-visibility: hidden;\r\n    backface-visibility: hidden;\r\n\t\r\n\tvisibility: visible;\r\n\topacity:1;\r\n\t\r\n\t/*top:0px;*/\r\n}\r\n.LFPP_Player_Min #LFPP_StickyVideoWrapper_Headline_Content {\r\n    -webkit-backface-visibility: hidden;\r\n\t-moz-backface-visibility: hidden;\r\n    backface-visibility: hidden;\r\n\t\r\n\tvisibility: hidden;\r\n\topacity: 0;\r\n\t/*top: -100px;*/\r\n\tz-index:-1;\r\n}\r\n\r\n\r\n/* fix for missing css when changing comment pages */\r\n#LFPP_StickyVideoWrapper_Outer .video-container{\r\n\tposition:relative;\r\n\t/*padding-bottom:56.25%;*/\r\n\t/*height:0;*/\r\n\toverflow:hidden;\r\n}\r\n#LFPP_StickyVideoWrapper_Outer .video-container iframe,\r\n#LFPP_StickyVideoWrapper_Outer .video-container object,\r\n#LFPP_StickyVideoWrapper_Outer .video-container embed {\r\n\tposition:absolute;\r\n\ttop:0;\r\n\tleft:0;\r\n\twidth:100%;\r\n\theight:100%;\r\n}\r\n\r\n`;var o=_.player={settings:{}},a=o._cache={},r=200,l=_.getLog("VideoPlayer");Object.defineProperties(_.player.settings,{enable_video_size_settings:{get:function(){return t("Video_Size",_.getSettingDefault("Video_Size")).indexOf("enable_video_size_settings")>-1},enumerable:!0,configurable:!1},enable_dynamic_width_video:{get:function(){return t("Video_Size",_.getSettingDefault("Video_Size")).indexOf("enable_dynamic_width_video")>-1},enumerable:!0,configurable:!1},enable_dynamic_width_video_animations:{get:function(){return t("Video_Size",_.getSettingDefault("Video_Size")).indexOf("enable_dynamic_width_video_animations")>-1},enumerable:!0,configurable:!1},enable_video_headline:{get:function(){return t("Video_Size",_.getSettingDefault("Video_Size")).indexOf("enable_video_headline")>-1},enumerable:!0,configurable:!1},Min_Video_Player_Height:{get:function(){return t("Min_Video_Player_Height",_.getSettingDefault("Min_Video_Player_Height")).trim()},enumerable:!0,configurable:!1}}),_.getDefaultAvailableVideoHeight=function(){return _.getViewportHeight()-_.getNavBottom()},_.getStickyVideoMinHeight=function(){return parseInt(_.getViewportHeight()/4)},_.getStickyVideoCurrentHeight=function(){var e,t=_.header.isNavPinned,n=window.pageYOffset;return e=t?n-(_.getHeaderBlockHeight()+_.getNavHeight()):n,e>0?t?Math.max(y-_.getNavBottom()-e,r):Math.max(y+(_.header.headerTotalActualHeight-e),r):_.getDefaultAvailableVideoHeight()};var s=0,d=0,u=0;o.updatePageHeight=function(){var e=parseInt(_.el.ipsLayout_body.outerHeight()+_.el.ipsLayout_footer.outerHeight()+y+_.header.headerTotalActualHeight)+"px";_.el.LFPP_FixedPage_Padding.css({"min-height":e,height:e})};var c={};a.onScroll=0,a.onScrollCooldown=null,o.onScroll=function(e,t){function n(){p=s,h=d,m=u,s=P,d=_.getViewportWidth(),u=_.getViewportHeight(),v=s-p,y=h-d,b=m-u}function i(e){var t=_.getNavBottom(),d=_.getStickyVideoCurrentHeight(),u=parseInt(_.el.LFPP_StickyVideoWrapper_Headline_Content.outerHeight());_.player.settings.enable_dynamic_width_video_animations?l?o.setPlayerHeight(d,t):o.setPlayerHeight(d,Math.max(t-s,0)):(l?_.el.LFPP_StickyVideoWrapper_Outer.css({height:d,top:t}):_.el.LFPP_StickyVideoWrapper_Outer.css({height:d,top:Math.max(t-s,0)}),_.el.LFPP_FixedPage_Wrapper.css({top:_.getViewportHeight()+u+_.header.headerTotalActualHeight-window.scrollY})),d>r||parseInt(_.el.LFPP_FixedPage_Wrapper.css("top"))-d-u+10>0?_.el.LFPP_StickyVideoWrapper_Outer.removeClass("LFPP_Player_Min"):_.el.LFPP_StickyVideoWrapper_Outer.addClass("LFPP_Player_Min"),o.updatePageHeight(),e||(a.onScrollCooldown=setTimeout(function(){a.onScrollCooldown=null,a.onScroll>1&&(a.onScroll=0,n(),i(!0))},1))}var l=_.header.isNavPinned;if(e&&"number"==typeof e.pageY){var f=c.pageY;if(c.pageY=e.pageY,"number"==typeof f&&!c.rescroll&&e.pageY>0&&!l){var g=parseInt(_.header.headerTotalActualHeight);if(10>Math.abs(g-e.pageY)&&g-e.pageY!=0&&Math.abs(e.pageY-f)>50)return c.rescroll=!0,e.preventDefault(),e.stopPropagation(),setAsap(function(){window.scrollTo(0,g)});if(10>e.pageY&&f-e.pageY>50)return c.rescroll=!0,e.preventDefault(),e.stopPropagation(),setAsap(function(){window.scrollTo(0,0)})}c.rescroll=!1}var p=0,h=0,m=0,v=0,y=0,b=0,P=window.pageYOffset;if(n(),a.onScrollCooldown){if(0===y&&0===b&&0===v)return a.onScroll++,o.updatePageHeight(),void _.el.LFPP_FixedPage_Wrapper.css({top:_.getViewportHeight()+parseInt(_.el.LFPP_StickyVideoWrapper_Headline_Content.outerHeight())+_.header.headerTotalActualHeight-window.scrollY});try{clearTimeout(a.onScrollCooldown)}catch(e){}a.onScrollCooldown=null}i()},o.onWindowResize=function(e,t){y=_.getViewportHeight(),b=_.getViewportWidth(),r=parseInt(y/4),_.el.LFPP_StickyVideoWrapper_Headline_Content.css({"max-width":_.contentMaxWidth+"px",width:_.breadcrumbWidth+"px"}),o.updatePageHeight(),o.onScroll()},o.setPlayerHeight=function(e,t,n){if(a.setPlayerHeight){if(!a.setPlayerHeightCancel)return a.setPlayerHeight;if(a.setPlayerHeight_newPlayerHeight===e&&a.setPlayerHeight_newPlayerTop===t)return a.setPlayerHeight;a.setPlayerHeightCancel()}return a.setPlayerHeight_newPlayerHeight=e,a.setPlayerHeight_newPlayerTop=t,a.setPlayerHeight=new Promise(function(n,i){var o=!1,r=!1,l=function(){o||r||(o=!0,a.setPlayerHeight=null,a.setPlayerHeightCancel=null,a.setPlayerHeight_newPlayerHeight=null,a.setPlayerHeight_newPlayerTop=null,n(!0))},s=function(){o||r||(r=!0,a.setPlayerHeight_newPlayerHeight=null,a.setPlayerHeight_newPlayerTop=null,_.el.LFPP_StickyVideoWrapper_Outer.velocity("stop",!0),_.el.LFPP_FixedPage_Wrapper.velocity("stop",!0),o=!0,a.setPlayerHeight=null,a.setPlayerHeightCancel=null,n(!1))};a.setPlayerHeightCancel=s;var d={height:e},u={top:_.getViewportHeight()+_.el.LFPP_StickyVideoWrapper_Headline_Content.height()+_.header.headerTotalActualHeight-window.scrollY},c=parseInt(_.el.LFPP_StickyVideoWrapper_Outer.css("height")),f=0,g=Math.abs(e-c);if("number"==typeof t){var p=parseInt(_.el.LFPP_StickyVideoWrapper_Outer.css("top"));p!==t&&(d.top=t,f=Math.abs(p-t))}if(0===f&&0===g&&parseInt(_.el.LFPP_StickyVideoWrapper_Outer.css("height"))===e)return _.el.LFPP_FixedPage_Wrapper.css({top:_.getViewportHeight()+parseInt(_.el.LFPP_StickyVideoWrapper_Headline_Content.outerHeight())+_.header.headerTotalActualHeight-window.scrollY}),setAsap(l);_.el.LFPP_StickyVideoWrapper_Outer.velocity(d,{duration:100,easing:"linear",complete:l,queue:!1}),_.el.LFPP_FixedPage_Wrapper.velocity(u,{duration:100,easing:"linear",complete:l,queue:!1})}),a.setPlayerHeight};var f=!1;_.page.onFooterReady=function(){if(_.isFPClubVideoPage){if(l("onFooterReady","Is Video Page"),y=_.getViewportHeight(),r=parseInt(y/4),c.pageY=window.pageYOffset,_.player.settings.enable_video_size_settings&&_.player.settings.enable_dynamic_width_video){var e=n();e&&"number"==typeof e()&&(_.getStickyVideoMinHeight=e),i(),setTimeout(function(){o.onScroll()},500)}}else l("onFooterReady","Is Not Video Page")}}();var V=!1,S=/Chrome/i.test(window.navigator.userAgent)&&/Google\s*Inc/i.test(window.navigator.vendor),H=!1,T=!1,I=!1;if(jMod.onDOMReady=s,jMod.beforescriptexecute=function(e){return c()},S){var C=0,L=null;L=setInterval(function(){if(!L||!0===c()||C>50){try{clearInterval(L)}catch(e){}L=null}C++},30)}_.SettingOptions={title:"LTT FP++ Settings",settings:[{name:"Video_Size",description:"Video Size",options:{enable_video_size_settings:{label:"Enable/Disable All Video Size Settings",on:"ON",off:"OFF"},enable_dynamic_width_video:{label:"Dynamic Video Player Size",on:"ON",off:"OFF",tooltip:{innerHTML:"Full width video that shrinks when you scroll down",placement:"right"}},enable_dynamic_width_video_animations:{label:"Animate Dynamic Video Player",on:"ON",off:"OFF",tooltip:{innerHTML:"Smooth out the height changes with CSS transitions",placement:"right"}},enable_video_headline:{label:"Show the video headline and download link",on:"ON",off:"OFF"}},tab:"Tab_Videos",section:"Player",type:"toggle",default:"enable_video_size_settings,enable_dynamic_width_video,enable_video_headline"},{name:"Min_Video_Player_Height",description:"Minimum video player height when scrolling down",tooltip:{innerHTML:"Valid examples: default, 300px, 1/3",placement:"top-left"},tab:"Tab_Videos",section:"Player",type:"input",default:"default"},{name:"Thumbs_General",description:"General",options:{add_thumbs_to_video_list:{label:"Add thumbnails to FP Club video topics",on:"ON",off:"OFF"},show_preview_on_hover:{label:"Show an animated preview on hover",on:"ON",off:"OFF"},keep_preview_after_hover:{label:"Keep preview visible after mouse leaves",on:"ON",off:"OFF",tooltip:{innerHTML:"Simply keeps the paused animation visible instead of hiding it",placement:"right"}}},tab:"Tab_VideoGallery",section:"Thumbs",type:"toggle",default:"add_thumbs_to_video_list,show_preview_on_hover"},{name:"thumb_animation_speed",description:"Thumbnail Animation Speed",min:20,max:1500,tooltip:{innerHTML:"Number of milliseconds between frames",placement:"top"},tab:"Tab_VideoGallery",section:"Thumbs",type:"range",default:"300"}],tabs:[{name:"About",innerHTML:[{type:"div",className:"row section-title-row",innerHTML:{type:"div",className:"col-md-12",innerHTML:{type:"h3",innerHTML:'<span>About<span style="text-align:right;float:right;margin-right:5px;opacity: 0.3;letter-spacing:0.1px;"><a href="https://linustechtips.com/main/profile/489159-jgjake2/" style="text-decoration: none;"><span style="color:black !important;">By jgjake2</span></a></span></span>',className:"section-title"}}},{type:"div",className:"row form-group section-row",innerHTML:['<div class="col-md-7"><h3 style="margin-top: 0;">LinusTechTips Floatplane Club++</h3><p>A greasemonkey script that make the Floatplane Club feel like a real media platform, rather than a janky add-on</p><p>If you have any issues, make sure report them on GitHub or in the LTT post.</p></div>','<div class="col-md-5"><u>Script Links</u><ul style="padding-left: 30px;margin-top: 5px;"><li><a href="https://github.com/jgjake2/LTT_FP">GitHub</a></li><li><a href="https://linustechtips.com/main/topic/777390-linustechtips-floatplane-club-greasemonkey-script/">LTT Thread</a></li></ul><u>Author:</u><ul style="padding-left: 30px;margin-top: 5px;"><li><a href="https://linustechtips.com/main/profile/489159-jgjake2/">LTT Forum</a></li><li><a href="https://www.facebook.com/jgjake2">Facebook</a></li><li><a href="https://github.com/jgjake2">GitHub Profile</a></li></ul></div>']}]},{name:"Tab_Videos",displayName:"Floatplane Videos",content:{footer:{type:"div",innerHTML:""}}},{name:"Tab_VideoGallery",displayName:"Video Gallery",content:{footer:{type:"div",innerHTML:""}}}],tabOrder:["About","Tab_Videos","Tab_VideoGallery"],activeTab:"Tab_Videos",onBeforeHide:function(e){console.log("Settings on before hide")}},_.getSettingDefault=function(e){for(var t=_.SettingOptions.settings,n=0;n<t.length;n++)if(t[n].name===e)return t[n].default},c()}($.noConflict());